{
  "version": 3,
  "sources": ["../../components/CrawlProgressIndicator.js"],
  "sourcesContent": ["/**\r\n * CrawlProgressIndicator.js\r\n * \r\n * Reusable component for displaying crawl progress with:\r\n * - Dual-level progress bars (main task + sub-task)\r\n * - Determinate progress (with known totals)\r\n * - Indeterminate progress (spinners)\r\n * - Stage labels and status indicators\r\n * - Telemetry integration\r\n * \r\n * Usage:\r\n *   const indicator = createCrawlProgressIndicator({\r\n *     container: document.getElementById('progress-container'),\r\n *     jobId: '2025-10-08_12-34-56',\r\n *     onStateChange: (state) => console.log('State changed:', state)\r\n *   });\r\n *   \r\n *   indicator.updateProgress({ visited: 10, total: 100, stage: 'crawling' });\r\n *   indicator.updateSubTask({ current: 5, total: 50, label: 'Processing countries' });\r\n *   indicator.setStage('analyzing');\r\n *   indicator.destroy();\r\n */\r\n\r\n/**\r\n * Create a crawl progress indicator instance\r\n * \r\n * @param {Object} options\r\n * @param {HTMLElement} options.container - Container element\r\n * @param {string} [options.jobId] - Job identifier\r\n * @param {Function} [options.onStateChange] - Callback when state changes\r\n * @returns {Object} Progress indicator API\r\n */\r\nfunction createCrawlProgressIndicator(options = {}) {\r\n  const {\r\n    container,\r\n    jobId = null,\r\n    onStateChange = null\r\n  } = options;\r\n\r\n  if (!container) {\r\n    throw new Error('CrawlProgressIndicator requires a container element');\r\n  }\r\n\r\n  // Internal state\r\n  const state = {\r\n    jobId,\r\n    mainTask: {\r\n      current: 0,\r\n      total: null,\r\n      percentage: 0,\r\n      stage: 'initializing',\r\n      stageLabel: 'Initializing',\r\n      status: 'running'\r\n    },\r\n    subTask: {\r\n      current: 0,\r\n      total: null,\r\n      percentage: 0,\r\n      label: null,\r\n      visible: false\r\n    },\r\n    telemetry: [],\r\n    lastUpdate: Date.now()\r\n  };\r\n\r\n  // Create DOM structure\r\n  const root = document.createElement('div');\r\n  root.className = 'crawl-progress-indicator';\r\n  root.dataset.jobId = jobId || '';\r\n\r\n  const header = document.createElement('div');\r\n  header.className = 'crawl-progress-indicator__header';\r\n  \r\n  const stageLabel = document.createElement('div');\r\n  stageLabel.className = 'crawl-progress-indicator__stage-label';\r\n  stageLabel.textContent = state.mainTask.stageLabel;\r\n  \r\n  const statusBadge = document.createElement('span');\r\n  statusBadge.className = 'crawl-progress-indicator__status-badge';\r\n  statusBadge.dataset.status = state.mainTask.status;\r\n  statusBadge.textContent = state.mainTask.status;\r\n  \r\n  header.appendChild(stageLabel);\r\n  header.appendChild(statusBadge);\r\n\r\n  // Main progress bar\r\n  const mainProgressContainer = document.createElement('div');\r\n  mainProgressContainer.className = 'crawl-progress-indicator__main-progress';\r\n  \r\n  const mainBar = document.createElement('div');\r\n  mainBar.className = 'progress-bar-container';\r\n  \r\n  const mainBarFill = document.createElement('div');\r\n  mainBarFill.className = 'progress-bar-fill';\r\n  mainBarFill.style.width = '0%';\r\n  \r\n  const mainBarLabel = document.createElement('div');\r\n  mainBarLabel.className = 'progress-bar-label';\r\n  mainBarLabel.textContent = '0%';\r\n  \r\n  mainBar.appendChild(mainBarFill);\r\n  mainBar.appendChild(mainBarLabel);\r\n  mainProgressContainer.appendChild(mainBar);\r\n\r\n  // Sub-task progress bar (initially hidden)\r\n  const subProgressContainer = document.createElement('div');\r\n  subProgressContainer.className = 'crawl-progress-indicator__sub-progress';\r\n  subProgressContainer.style.display = 'none';\r\n  \r\n  const subTaskLabel = document.createElement('div');\r\n  subTaskLabel.className = 'crawl-progress-indicator__sub-label';\r\n  \r\n  const subBar = document.createElement('div');\r\n  subBar.className = 'progress-bar-container progress-bar-container--small';\r\n  \r\n  const subBarFill = document.createElement('div');\r\n  subBarFill.className = 'progress-bar-fill progress-bar-fill--sub';\r\n  subBarFill.style.width = '0%';\r\n  \r\n  const subBarLabel = document.createElement('div');\r\n  subBarLabel.className = 'progress-bar-label progress-bar-label--small';\r\n  subBarLabel.textContent = '0%';\r\n  \r\n  subBar.appendChild(subBarFill);\r\n  subBar.appendChild(subBarLabel);\r\n  subProgressContainer.appendChild(subTaskLabel);\r\n  subProgressContainer.appendChild(subBar);\r\n\r\n  // Assemble\r\n  root.appendChild(header);\r\n  root.appendChild(mainProgressContainer);\r\n  root.appendChild(subProgressContainer);\r\n  container.appendChild(root);\r\n\r\n  /**\r\n   * Update main task progress\r\n   * \r\n   * @param {Object} progress\r\n   * @param {number} [progress.current] - Current value\r\n   * @param {number} [progress.total] - Total value (null for indeterminate)\r\n   * @param {string} [progress.stage] - Stage identifier\r\n   * @param {string} [progress.stageLabel] - Human-readable stage label\r\n   * @param {string} [progress.status] - Status (running, paused, completed, failed)\r\n   */\r\n  function updateProgress(progress = {}) {\r\n    if (progress.stage && progress.stage !== state.mainTask.stage) {\r\n      state.mainTask.stage = progress.stage;\r\n      state.mainTask.stageLabel = progress.stageLabel || capitalizeStage(progress.stage);\r\n      stageLabel.textContent = state.mainTask.stageLabel;\r\n    }\r\n\r\n    if (progress.stageLabel) {\r\n      state.mainTask.stageLabel = progress.stageLabel;\r\n      stageLabel.textContent = progress.stageLabel;\r\n    }\r\n\r\n    if (progress.status && progress.status !== state.mainTask.status) {\r\n      state.mainTask.status = progress.status;\r\n      statusBadge.textContent = progress.status;\r\n      statusBadge.dataset.status = progress.status;\r\n    }\r\n\r\n    if (typeof progress.current === 'number') {\r\n      state.mainTask.current = progress.current;\r\n    }\r\n\r\n    if (typeof progress.total === 'number' || progress.total === null) {\r\n      state.mainTask.total = progress.total;\r\n    }\r\n\r\n    // Calculate percentage\r\n    if (state.mainTask.total && state.mainTask.total > 0) {\r\n      state.mainTask.percentage = Math.round((state.mainTask.current / state.mainTask.total) * 100);\r\n      mainBarFill.style.width = `${state.mainTask.percentage}%`;\r\n      mainBarLabel.textContent = `${state.mainTask.current} / ${state.mainTask.total} (${state.mainTask.percentage}%)`;\r\n      mainBarFill.classList.remove('progress-bar-fill--indeterminate');\r\n    } else {\r\n      // Indeterminate\r\n      mainBarFill.classList.add('progress-bar-fill--indeterminate');\r\n      mainBarLabel.textContent = state.mainTask.current > 0 \r\n        ? `${state.mainTask.current} processed` \r\n        : 'Processing...';\r\n    }\r\n\r\n    state.lastUpdate = Date.now();\r\n    notifyStateChange();\r\n  }\r\n\r\n  /**\r\n   * Update sub-task progress\r\n   * \r\n   * @param {Object} subTask\r\n   * @param {number} [subTask.current] - Current value\r\n   * @param {number} [subTask.total] - Total value (null for indeterminate)\r\n   * @param {string} [subTask.label] - Sub-task label\r\n   * @param {boolean} [subTask.visible] - Show/hide sub-task bar\r\n   */\r\n  function updateSubTask(subTask = {}) {\r\n    if (typeof subTask.visible === 'boolean') {\r\n      state.subTask.visible = subTask.visible;\r\n      subProgressContainer.style.display = subTask.visible ? 'block' : 'none';\r\n    }\r\n\r\n    if (subTask.label !== undefined) {\r\n      state.subTask.label = subTask.label;\r\n      subTaskLabel.textContent = subTask.label || '';\r\n    }\r\n\r\n    if (typeof subTask.current === 'number') {\r\n      state.subTask.current = subTask.current;\r\n    }\r\n\r\n    if (typeof subTask.total === 'number' || subTask.total === null) {\r\n      state.subTask.total = subTask.total;\r\n    }\r\n\r\n    // Calculate percentage\r\n    if (state.subTask.total && state.subTask.total > 0) {\r\n      state.subTask.percentage = Math.round((state.subTask.current / state.subTask.total) * 100);\r\n      subBarFill.style.width = `${state.subTask.percentage}%`;\r\n      subBarLabel.textContent = `${state.subTask.current} / ${state.subTask.total} (${state.subTask.percentage}%)`;\r\n      subBarFill.classList.remove('progress-bar-fill--indeterminate');\r\n    } else if (state.subTask.visible) {\r\n      // Indeterminate\r\n      subBarFill.classList.add('progress-bar-fill--indeterminate');\r\n      subBarLabel.textContent = state.subTask.current > 0 \r\n        ? `${state.subTask.current} processed` \r\n        : 'Processing...';\r\n    }\r\n\r\n    // Auto-show if not explicitly hidden\r\n    if (state.subTask.label && typeof subTask.visible !== 'boolean') {\r\n      state.subTask.visible = true;\r\n      subProgressContainer.style.display = 'block';\r\n    }\r\n\r\n    state.lastUpdate = Date.now();\r\n    notifyStateChange();\r\n  }\r\n\r\n  /**\r\n   * Set stage without updating progress\r\n   * \r\n   * @param {string} stage - Stage identifier\r\n   * @param {string} [label] - Human-readable label\r\n   */\r\n  function setStage(stage, label = null) {\r\n    updateProgress({ stage, stageLabel: label });\r\n  }\r\n\r\n  /**\r\n   * Set status\r\n   * \r\n   * @param {string} status - Status (running, paused, completed, failed)\r\n   */\r\n  function setStatus(status) {\r\n    updateProgress({ status });\r\n  }\r\n\r\n  /**\r\n   * Hide sub-task bar\r\n   */\r\n  function hideSubTask() {\r\n    updateSubTask({ visible: false });\r\n  }\r\n\r\n  /**\r\n   * Show sub-task bar\r\n   */\r\n  function showSubTask() {\r\n    updateSubTask({ visible: true });\r\n  }\r\n\r\n  /**\r\n   * Get current state\r\n   * \r\n   * @returns {Object} Current state snapshot\r\n   */\r\n  function getState() {\r\n    return JSON.parse(JSON.stringify(state));\r\n  }\r\n\r\n  /**\r\n   * Destroy the indicator and clean up\r\n   */\r\n  function destroy() {\r\n    if (root && root.parentNode) {\r\n      root.parentNode.removeChild(root);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Capitalize stage name\r\n   * \r\n   * @param {string} stage\r\n   * @returns {string}\r\n   */\r\n  function capitalizeStage(stage) {\r\n    if (!stage) return 'Processing';\r\n    return stage\r\n      .split(/[-_]/)\r\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n      .join(' ');\r\n  }\r\n\r\n  /**\r\n   * Notify state change callback\r\n   */\r\n  function notifyStateChange() {\r\n    if (typeof onStateChange === 'function') {\r\n      try {\r\n        onStateChange(getState());\r\n      } catch (_) {}\r\n    }\r\n  }\r\n\r\n  // Public API\r\n  return {\r\n    updateProgress,\r\n    updateSubTask,\r\n    setStage,\r\n    setStatus,\r\n    hideSubTask,\r\n    showSubTask,\r\n    getState,\r\n    destroy,\r\n    // Direct element access for custom styling\r\n    elements: {\r\n      root,\r\n      header,\r\n      stageLabel,\r\n      statusBadge,\r\n      mainBar,\r\n      mainBarFill,\r\n      mainBarLabel,\r\n      subProgressContainer,\r\n      subTaskLabel,\r\n      subBar,\r\n      subBarFill,\r\n      subBarLabel\r\n    }\r\n  };\r\n}\r\n\r\n// Export for module usage\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = { createCrawlProgressIndicator };\r\n}\r\n\r\n// Export for browser\r\nif (typeof window !== 'undefined') {\r\n  window.createCrawlProgressIndicator = createCrawlProgressIndicator;\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
