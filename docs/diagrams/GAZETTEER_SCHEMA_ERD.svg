<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 880">
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-opacity="0.12"/>
    </filter>
    <filter id="shadow-sm" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.1"/>
    </filter>
    <marker id="fk" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <path d="M 0 0 L 10 3.5 L 0 7 L 2 3.5 Z" fill="#94a3b8"/>
    </marker>
    <linearGradient id="place" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#60a5fa"/><stop offset="100%" stop-color="#3b82f6"/>
    </linearGradient>
    <linearGradient id="name" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#4ade80"/><stop offset="100%" stop-color="#22c55e"/>
    </linearGradient>
    <linearGradient id="hier" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#fb923c"/><stop offset="100%" stop-color="#f97316"/>
    </linearGradient>
    <linearGradient id="ext" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#a78bfa"/><stop offset="100%" stop-color="#8b5cf6"/>
    </linearGradient>
    <linearGradient id="src" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#f87171"/><stop offset="100%" stop-color="#ef4444"/>
    </linearGradient>
    <linearGradient id="attr" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#fbbf24"/><stop offset="100%" stop-color="#f59e0b"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="1100" height="880" fill="#f8fafc"/>
  
  <!-- Header -->
  <rect width="1100" height="75" fill="#0f172a"/>
  <text x="550" y="35" font-family="Inter, system-ui, sans-serif" font-size="24" font-weight="700" text-anchor="middle" fill="#ffffff">Gazetteer Schema ERD</text>
  <text x="550" y="58" font-family="Inter, system-ui, sans-serif" font-size="13" text-anchor="middle" fill="#94a3b8">Entity-Relationship Diagram for gazetteer.db Tables</text>
  
  <!-- Main places table (center) -->
  <g filter="url(#shadow)">
    <rect x="390" y="110" width="320" height="280" rx="12" fill="#ffffff" stroke="#3b82f6" stroke-width="3"/>
    <rect x="390" y="110" width="320" height="40" rx="12" fill="url(#place)"/>
    <rect x="390" y="138" width="320" height="12" fill="url(#place)"/>
    <text x="550" y="138" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" text-anchor="middle" fill="#ffffff">places</text>
    <text x="410" y="180" font-family="JetBrains Mono, monospace" font-size="10" fill="#2563eb">ðŸ”‘ id INTEGER PRIMARY KEY</text>
    <text x="410" y="200" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   kind TEXT NOT NULL</text>
    <text x="410" y="220" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   population INTEGER</text>
    <text x="410" y="240" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   latitude REAL</text>
    <text x="410" y="260" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   longitude REAL</text>
    <text x="410" y="280" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   area_km2 REAL</text>
    <text x="410" y="300" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   wikidata_qid TEXT UNIQUE</text>
    <text x="410" y="320" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   canonical_name_id INTEGER FK</text>
    <text x="410" y="340" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   created_at, updated_at TEXT</text>
    <text x="410" y="365" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   IDX: kind, population, wikidata_qid</text>
  </g>
  
  <!-- place_names table (right) -->
  <g filter="url(#shadow)">
    <rect x="780" y="110" width="280" height="220" rx="12" fill="#ffffff" stroke="#22c55e" stroke-width="3"/>
    <rect x="780" y="110" width="280" height="40" rx="12" fill="url(#name)"/>
    <rect x="780" y="138" width="280" height="12" fill="url(#name)"/>
    <text x="920" y="138" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" text-anchor="middle" fill="#ffffff">place_names</text>
    <text x="800" y="180" font-family="JetBrains Mono, monospace" font-size="10" fill="#16a34a">ðŸ”‘ id INTEGER PRIMARY KEY</text>
    <text x="800" y="200" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”— place_id INTEGER FK NOT NULL</text>
    <text x="800" y="220" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   name TEXT NOT NULL</text>
    <text x="800" y="240" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   normalized TEXT</text>
    <text x="800" y="260" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   lang TEXT (en, zh, ar...)</text>
    <text x="800" y="280" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   name_kind TEXT (common/official)</text>
    <text x="800" y="300" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   is_preferred, is_official BOOL</text>
    <text x="800" y="322" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   IDX: place_id, normalized</text>
  </g>
  
  <!-- FK arrow places -> place_names -->
  <line x1="710" y1="200" x2="780" y2="200" stroke="#94a3b8" stroke-width="2" marker-end="url(#fk)"/>
  <text x="745" y="215" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#64748b">1:N</text>
  
  <!-- place_hierarchy table (left) -->
  <g filter="url(#shadow)">
    <rect x="40" y="110" width="280" height="200" rx="12" fill="#ffffff" stroke="#f97316" stroke-width="3"/>
    <rect x="40" y="110" width="280" height="40" rx="12" fill="url(#hier)"/>
    <rect x="40" y="138" width="280" height="12" fill="url(#hier)"/>
    <text x="180" y="138" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" text-anchor="middle" fill="#ffffff">place_hierarchy</text>
    <text x="60" y="180" font-family="JetBrains Mono, monospace" font-size="10" fill="#ea580c">ðŸ”‘ id INTEGER PRIMARY KEY</text>
    <text x="60" y="200" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”— parent_id INTEGER FK NOT NULL</text>
    <text x="60" y="220" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”— child_id INTEGER FK NOT NULL</text>
    <text x="60" y="240" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   relation_type TEXT NOT NULL</text>
    <text x="60" y="260" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   (admin_parent, capital_of...)</text>
    <text x="60" y="282" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   UNIQUE(parent_id, child_id, type)</text>
    <text x="60" y="300" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   IDX: parent, child</text>
  </g>
  
  <!-- FK arrows places <- place_hierarchy -->
  <line x1="390" y1="175" x2="320" y2="175" stroke="#94a3b8" stroke-width="2" marker-end="url(#fk)"/>
  <text x="355" y="165" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#64748b">parent</text>
  <line x1="390" y1="220" x2="320" y2="220" stroke="#94a3b8" stroke-width="2" marker-end="url(#fk)"/>
  <text x="355" y="235" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#64748b">child</text>
  
  <!-- place_external_ids table (bottom left) -->
  <g filter="url(#shadow)">
    <rect x="40" y="400" width="280" height="200" rx="12" fill="#ffffff" stroke="#8b5cf6" stroke-width="3"/>
    <rect x="40" y="400" width="280" height="40" rx="12" fill="url(#ext)"/>
    <rect x="40" y="428" width="280" height="12" fill="url(#ext)"/>
    <text x="180" y="428" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" text-anchor="middle" fill="#ffffff">place_external_ids</text>
    <text x="60" y="470" font-family="JetBrains Mono, monospace" font-size="10" fill="#7c3aed">ðŸ”‘ id INTEGER PRIMARY KEY</text>
    <text x="60" y="490" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”— place_id INTEGER FK NOT NULL</text>
    <text x="60" y="510" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   source TEXT NOT NULL</text>
    <text x="60" y="530" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   (wikidata, osm, geonames...)</text>
    <text x="60" y="550" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   external_id TEXT NOT NULL</text>
    <text x="60" y="572" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   UNIQUE(source, external_id)</text>
    <text x="60" y="590" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   IDX: source, place_id</text>
  </g>
  
  <!-- FK arrow places -> place_external_ids -->
  <line x1="450" y1="390" x2="250" y2="400" stroke="#94a3b8" stroke-width="2" marker-end="url(#fk)"/>
  <text x="350" y="385" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#64748b">1:N</text>
  
  <!-- place_sources table (bottom center) -->
  <g filter="url(#shadow)">
    <rect x="390" y="470" width="320" height="180" rx="12" fill="#ffffff" stroke="#ef4444" stroke-width="3"/>
    <rect x="390" y="470" width="320" height="40" rx="12" fill="url(#src)"/>
    <rect x="390" y="498" width="320" height="12" fill="url(#src)"/>
    <text x="550" y="498" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" text-anchor="middle" fill="#ffffff">place_sources</text>
    <text x="410" y="540" font-family="JetBrains Mono, monospace" font-size="10" fill="#dc2626">ðŸ”‘ id INTEGER PRIMARY KEY</text>
    <text x="410" y="560" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”— place_id INTEGER FK NOT NULL</text>
    <text x="410" y="580" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   source_name TEXT NOT NULL</text>
    <text x="410" y="600" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   source_url TEXT</text>
    <text x="410" y="620" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   fetched_at TEXT</text>
    <text x="410" y="640" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   raw_data TEXT (JSON)</text>
  </g>
  
  <!-- FK arrow places -> place_sources -->
  <line x1="550" y1="390" x2="550" y2="470" stroke="#94a3b8" stroke-width="2" marker-end="url(#fk)"/>
  <text x="560" y="430" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#64748b">1:N</text>
  
  <!-- place_attribute_values table (bottom right) -->
  <g filter="url(#shadow)">
    <rect x="780" y="400" width="280" height="200" rx="12" fill="#ffffff" stroke="#f59e0b" stroke-width="3"/>
    <rect x="780" y="400" width="280" height="40" rx="12" fill="url(#attr)"/>
    <rect x="780" y="428" width="280" height="12" fill="url(#attr)"/>
    <text x="920" y="428" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" text-anchor="middle" fill="#ffffff">place_attribute_values</text>
    <text x="800" y="470" font-family="JetBrains Mono, monospace" font-size="10" fill="#ca8a04">ðŸ”‘ id INTEGER PRIMARY KEY</text>
    <text x="800" y="490" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”— place_id INTEGER FK NOT NULL</text>
    <text x="800" y="510" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”— attribute_id INTEGER FK</text>
    <text x="800" y="530" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   value TEXT</text>
    <text x="800" y="550" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   value_number REAL</text>
    <text x="800" y="570" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   valid_from TEXT</text>
    <text x="800" y="590" font-family="JetBrains Mono, monospace" font-size="9" fill="#94a3b8">   (GDP, area, timezone...)</text>
  </g>
  
  <!-- FK arrow places -> place_attribute_values -->
  <line x1="710" y1="340" x2="850" y2="400" stroke="#94a3b8" stroke-width="2" marker-end="url(#fk)"/>
  <text x="780" y="360" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#64748b">1:N</text>
  
  <!-- ingestion_runs table (far bottom) -->
  <g filter="url(#shadow-sm)">
    <rect x="780" y="660" width="280" height="130" rx="10" fill="#ffffff" stroke="#94a3b8" stroke-width="2"/>
    <rect x="780" y="660" width="280" height="35" rx="10" fill="#64748b"/>
    <rect x="780" y="683" width="280" height="12" fill="#64748b"/>
    <text x="920" y="685" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700" text-anchor="middle" fill="#ffffff">ingestion_runs</text>
    <text x="800" y="720" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">ðŸ”‘ id INTEGER PRIMARY KEY</text>
    <text x="800" y="740" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   ingestor_name TEXT</text>
    <text x="800" y="760" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   started_at, completed_at TEXT</text>
    <text x="800" y="780" font-family="JetBrains Mono, monospace" font-size="10" fill="#475569">   records_processed INTEGER</text>
  </g>
  
  <!-- Legend -->
  <rect x="40" y="680" width="650" height="180" rx="12" fill="#ffffff" stroke="#e2e8f0" stroke-width="1" filter="url(#shadow)"/>
  <text x="60" y="710" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700" fill="#0f172a">Schema Legend</text>
  
  <!-- Symbols -->
  <text x="60" y="740" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#475569">ðŸ”‘ Primary Key</text>
  <text x="180" y="740" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#475569">ðŸ”— Foreign Key</text>
  <text x="300" y="740" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#475569">1:N One-to-Many relationship</text>
  
  <!-- Table descriptions -->
  <rect x="60" y="755" width="18" height="18" rx="4" fill="#3b82f6"/>
  <text x="88" y="768" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#475569"><tspan font-weight="600">places:</tspan> Core entity (kind, coords, pop)</text>
  
  <rect x="60" y="778" width="18" height="18" rx="4" fill="#22c55e"/>
  <text x="88" y="791" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#475569"><tspan font-weight="600">place_names:</tspan> Multi-lingual names</text>
  
  <rect x="60" y="801" width="18" height="18" rx="4" fill="#f97316"/>
  <text x="88" y="814" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#475569"><tspan font-weight="600">place_hierarchy:</tspan> Parent-child rels</text>
  
  <rect x="60" y="824" width="18" height="18" rx="4" fill="#8b5cf6"/>
  <text x="88" y="837" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#475569"><tspan font-weight="600">place_external_ids:</tspan> QID, OSM, GeoNames</text>
  
  <rect x="350" y="755" width="18" height="18" rx="4" fill="#ef4444"/>
  <text x="378" y="768" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#475569"><tspan font-weight="600">place_sources:</tspan> Data provenance</text>
  
  <rect x="350" y="778" width="18" height="18" rx="4" fill="#f59e0b"/>
  <text x="378" y="791" font-family="Inter, system-ui, sans-serif" font-size="9" fill="#475569"><tspan font-weight="600">place_attribute_values:</tspan> Extensible attrs</text>
</svg>