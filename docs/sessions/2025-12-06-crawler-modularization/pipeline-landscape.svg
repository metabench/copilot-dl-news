<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 720" role="img" aria-labelledby="title desc">
  <title id="title">Pipeline-over-flags wiring — landscape metaphor</title>
  <desc id="desc">Green industrial luxury landscape with a blue sky, snow-capped mountains, cloud info boxes, a sun badge, and sequential steps joined by arrows.</desc>
  <defs>
    <!-- Sky gradient with atmospheric perspective -->
    <linearGradient id="sky" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#2d7eb8"/>
      <stop offset="40%" stop-color="#5ba8d4"/>
      <stop offset="70%" stop-color="#8fd4f0"/>
      <stop offset="100%" stop-color="#d4eef8"/>
    </linearGradient>
    <!-- Ground gradient (rich green meadow) -->
    <linearGradient id="ground" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#0d2a1d"/>
      <stop offset="40%" stop-color="#145531"/>
      <stop offset="100%" stop-color="#1e8049"/>
    </linearGradient>
    <!-- Distant mountain (bluish haze) -->
    <linearGradient id="distantMtn" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#8ba8b5"/>
      <stop offset="100%" stop-color="#6b8f9a"/>
    </linearGradient>
    <!-- Mid mountain -->
    <linearGradient id="midMtn" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#4a7a6a"/>
      <stop offset="100%" stop-color="#2d5545"/>
    </linearGradient>
    <!-- Near hills -->
    <linearGradient id="nearHill" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#266e48"/>
      <stop offset="100%" stop-color="#1b5035"/>
    </linearGradient>
    <!-- Snow cap gradient -->
    <linearGradient id="snowCap" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#ffffff"/>
      <stop offset="60%" stop-color="#e8f4fc"/>
      <stop offset="100%" stop-color="#c8dce8"/>
    </linearGradient>
    <!-- Sun glow with corona -->
    <radialGradient id="sunGlow" cx="50%" cy="50%" r="50%">
      <stop offset="0%" stop-color="#fff8dc"/>
      <stop offset="50%" stop-color="#ffe066"/>
      <stop offset="100%" stop-color="#ffb84d"/>
    </radialGradient>
    <radialGradient id="sunCorona" cx="50%" cy="50%" r="60%">
      <stop offset="60%" stop-color="#fff4b0" stop-opacity="0.4"/>
      <stop offset="100%" stop-color="#ffcc00" stop-opacity="0"/>
    </radialGradient>
    <!-- Cloud fills -->
    <linearGradient id="cloudFill" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#ffffff"/>
      <stop offset="100%" stop-color="#e3f2fd"/>
    </linearGradient>
    <!-- Step box -->
    <linearGradient id="stepBox" x1="0" x2="1" y1="0" y2="1">
      <stop offset="0%" stop-color="#1a5438"/>
      <stop offset="100%" stop-color="#0e3522"/>
    </linearGradient>
    <linearGradient id="stepStroke" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#5cf5ab"/>
      <stop offset="100%" stop-color="#3dd98a"/>
    </linearGradient>
    <!-- River/stream gradient -->
    <linearGradient id="stream" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#3a9fbf"/>
      <stop offset="50%" stop-color="#5bc0de"/>
      <stop offset="100%" stop-color="#3a9fbf"/>
    </linearGradient>
    <!-- Arrow marker -->
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#5cf5ab"/>
    </marker>
    <!-- Drop shadow for cards -->
    <filter id="cardShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="4" stdDeviation="4" flood-color="#062e18" flood-opacity="0.5"/>
    </filter>
    <!-- Soft blur for atmosphere -->
    <filter id="atmosphereBlur" x="-10%" y="-10%" width="120%" height="120%">
      <feGaussianBlur stdDeviation="2"/>
    </filter>
    <style>
      text {
        font-family: "Segoe UI", "Trebuchet MS", sans-serif;
      }
      .label {
        font-size: 15px;
        font-weight: 600;
        fill: #d8fff0;
      }
      .hint {
        font-size: 12px;
        fill: #a3e4c4;
      }
      .cloud-text {
        font-size: 13px;
        fill: #1b4332;
        font-weight: 600;
      }
      .sun-label {
        font-size: 11px;
        fill: #5a3d0a;
        font-weight: 700;
      }
      .ground-label {
        font-size: 14px;
        fill: #b6f5d7;
        font-weight: 500;
      }
    </style>
  </defs>

  <!-- === SKY === -->
  <rect x="0" y="0" width="1200" height="440" fill="url(#sky)"/>
  
  <!-- === DISTANT MOUNTAINS WITH SNOW CAPS (far, hazy) === -->
  <g opacity="0.5" filter="url(#atmosphereBlur)">
    <!-- Far range left -->
    <path d="M -80 440 L 40 300 L 100 340 L 180 260 L 260 320 L 340 280 L 420 350 L 500 310 L 580 380 L 580 440 Z" fill="url(#distantMtn)"/>
    <!-- Far range right -->
    <path d="M 500 440 L 620 320 L 700 370 L 800 250 L 900 310 L 1000 270 L 1100 340 L 1250 440 Z" fill="url(#distantMtn)"/>
  </g>
  
  <!-- === SNOW CAPS (asymmetric shapes matching mountain slopes) === -->
  <g opacity="0.9">
    <!-- Peak 180,260: slopes go to 100,340 (left) and 260,320 (right) - asymmetric steep left -->
    <path d="M 180 260 L 155 295 Q 162 290 172 288 L 180 275 L 192 292 Q 200 295 210 298 L 180 260 Z" fill="url(#snowCap)"/>
    <!-- Snow streak down left face -->
    <path d="M 165 290 Q 155 310 148 320" fill="none" stroke="#e8f4fc" stroke-width="4" opacity="0.5" stroke-linecap="round"/>
    
    <!-- Peak 340,280: slopes to 260,320 (left) and 420,350 (right) - gentler slopes -->
    <path d="M 340 280 L 318 310 Q 328 305 335 300 L 340 292 L 348 302 Q 358 308 368 315 L 340 280 Z" fill="url(#snowCap)"/>
    
    <!-- Peak 800,250 (tallest): slopes to 700,370 (left) and 900,310 (right) - dramatic asymmetric -->
    <path d="M 800 250 L 765 300 Q 778 290 788 282 L 800 268 L 815 288 Q 828 298 842 308 L 800 250 Z" fill="url(#snowCap)"/>
    <!-- Snow streak on north face -->
    <path d="M 780 290 Q 765 320 755 345" fill="none" stroke="#e8f4fc" stroke-width="5" opacity="0.45" stroke-linecap="round"/>
    <path d="M 795 295 Q 788 315 782 335" fill="none" stroke="#ffffff" stroke-width="2" opacity="0.3" stroke-linecap="round"/>
    
    <!-- Peak 1000,270: slopes to 900,310 (left) and 1100,340 (right) -->
    <path d="M 1000 270 L 975 305 Q 985 298 993 292 L 1000 282 L 1010 295 Q 1020 302 1032 310 L 1000 270 Z" fill="url(#snowCap)"/>
    <!-- Subtle snow streak -->
    <path d="M 988 300 Q 980 318 975 330" fill="none" stroke="#e8f4fc" stroke-width="3" opacity="0.4" stroke-linecap="round"/>
    
    <!-- Secondary peaks - smaller patches -->
    <path d="M 500 310 L 488 332 Q 494 328 500 322 Q 506 328 512 332 L 500 310 Z" fill="url(#snowCap)" opacity="0.55"/>
    <path d="M 620 320 L 610 340 Q 615 336 620 330 Q 625 336 630 340 L 620 320 Z" fill="url(#snowCap)" opacity="0.45"/>
    <!-- Tiny patch on 40,300 peak -->
    <path d="M 40 300 L 32 318 Q 36 314 40 308 Q 44 314 48 318 L 40 300 Z" fill="url(#snowCap)" opacity="0.35"/>
  </g>
  
  <!-- === MID-RANGE MOUNTAINS === -->
  <g opacity="0.7">
    <path d="M -40 440 L 80 360 L 160 400 L 280 340 L 400 390 L 520 350 L 620 400 L 620 440 Z" fill="url(#midMtn)"/>
    <path d="M 540 440 L 660 370 L 760 410 L 900 340 L 1020 390 L 1140 360 L 1250 400 L 1250 440 Z" fill="url(#midMtn)"/>
  </g>
  
  <!-- === MIST/FOG LAYER (atmospheric depth) === -->
  <g opacity="0.25">
    <ellipse cx="200" cy="420" rx="180" ry="25" fill="#c8dce8"/>
    <ellipse cx="500" cy="430" rx="220" ry="30" fill="#d4eef8"/>
    <ellipse cx="850" cy="415" rx="200" ry="22" fill="#c8dce8"/>
    <ellipse cx="1100" cy="425" rx="150" ry="20" fill="#d4eef8"/>
  </g>
  
  <!-- === FOREGROUND ROLLING HILLS === -->
  <path d="M -20 480 Q 80 450 180 465 Q 320 440 480 460 Q 640 435 800 455 Q 960 440 1120 460 Q 1200 450 1220 480 L 1220 720 L -20 720 Z" fill="url(#ground)"/>
  
  <!-- === WINDING STREAM WITH REFLECTIONS === -->
  <g>
    <!-- Main stream body -->
    <path d="M 1220 620 Q 1100 610 1000 630 Q 880 600 780 625 Q 660 595 560 620 Q 440 590 340 615 Q 220 585 100 610 Q 40 595 -20 605" 
          fill="none" stroke="url(#stream)" stroke-width="10" stroke-linecap="round" opacity="0.65"/>
    <!-- Highlight shimmer -->
    <path d="M 1220 618 Q 1100 608 1000 628 Q 880 598 780 623 Q 660 593 560 618 Q 440 588 340 613 Q 220 583 100 608 Q 40 593 -20 603" 
          fill="none" stroke="#c5e8f5" stroke-width="3" stroke-linecap="round" opacity="0.6"/>
    <!-- Edge definition -->
    <path d="M 1220 624 Q 1100 614 1000 634 Q 880 604 780 629 Q 660 599 560 624 Q 440 594 340 619 Q 220 589 100 614 Q 40 599 -20 609" 
          fill="none" stroke="#2a7a99" stroke-width="1" stroke-linecap="round" opacity="0.4"/>
  </g>
  
  <!-- === MEADOW TEXTURE (grass variations) === -->
  <g opacity="0.25">
    <ellipse cx="120" cy="540" rx="90" ry="22" fill="#1a7040"/>
    <ellipse cx="380" cy="560" rx="110" ry="28" fill="#1d7a48"/>
    <ellipse cx="660" cy="530" rx="100" ry="24" fill="#1a7040"/>
    <ellipse cx="920" cy="555" rx="95" ry="22" fill="#1d7a48"/>
    <ellipse cx="1100" cy="535" rx="80" ry="20" fill="#1a7040"/>
  </g>
  
  <!-- === TREE CLUSTERS (varied sizes and shapes for depth) === -->
  <g>
    <!-- Left cluster - mixed conifers -->
    <path d="M 42 465 Q 38 445 42 430 Q 46 445 42 465" fill="#0f3d22" opacity="0.6"/>
    <path d="M 65 468 Q 58 438 65 418 Q 72 438 65 468" fill="#0d3520" opacity="0.55"/>
    <path d="M 92 470 Q 88 452 92 438 Q 96 452 92 470" fill="#0f3d22" opacity="0.5"/>
    <!-- Tiny shrubs -->
    <ellipse cx="52" cy="472" rx="6" ry="3" fill="#0d3520" opacity="0.4"/>
    
    <!-- Center-left cluster -->
    <path d="M 262 458 Q 254 428 262 408 Q 270 428 262 458" fill="#0d3520" opacity="0.55"/>
    <path d="M 300 462 Q 294 438 300 422 Q 306 438 300 462" fill="#0f3d22" opacity="0.5"/>
    <ellipse cx="280" cy="465" rx="8" ry="3" fill="#0d3520" opacity="0.35"/>
    
    <!-- Center cluster -->
    <path d="M 565 455 Q 555 420 565 398 Q 575 420 565 455" fill="#0d3520" opacity="0.55"/>
    <path d="M 608 460 Q 600 432 608 415 Q 616 432 608 460" fill="#0f3d22" opacity="0.5"/>
    <path d="M 640 463 Q 634 445 640 432 Q 646 445 640 463" fill="#0d3520" opacity="0.45"/>
    
    <!-- Right cluster -->
    <path d="M 845 458 Q 837 428 845 410 Q 853 428 845 458" fill="#0d3520" opacity="0.55"/>
    <path d="M 885 462 Q 879 440 885 428 Q 891 440 885 462" fill="#0f3d22" opacity="0.5"/>
    
    <!-- Far right cluster -->
    <path d="M 1055 460 Q 1045 428 1055 408 Q 1065 428 1055 460" fill="#0d3520" opacity="0.55"/>
    <path d="M 1098 464 Q 1090 440 1098 422 Q 1106 440 1098 464" fill="#0f3d22" opacity="0.5"/>
    <path d="M 1135 467 Q 1129 450 1135 438 Q 1141 450 1135 467" fill="#0d3520" opacity="0.45"/>
    <ellipse cx="1115" cy="470" rx="7" ry="3" fill="#0d3520" opacity="0.35"/>
  </g>
  
  <!-- === GRASS TUFTS (foreground detail) === -->
  <g stroke="#1a5535" stroke-width="1.5" stroke-linecap="round" opacity="0.4">
    <path d="M 100 595 Q 98 585 100 575 M 100 595 Q 103 583 108 575 M 100 595 Q 96 583 92 576"/>
    <path d="M 350 600 Q 348 590 350 580 M 350 600 Q 353 588 358 580 M 350 600 Q 346 588 342 581"/>
    <path d="M 680 590 Q 678 580 680 570 M 680 590 Q 683 578 688 570"/>
    <path d="M 1000 592 Q 998 582 1000 572 M 1000 592 Q 1003 580 1008 572 M 1000 592 Q 996 580 992 573"/>
  </g>
  
  <!-- === ROCKS/BOULDERS (meadow details) === -->
  <g fill="#3d5c4a" opacity="0.4">
    <ellipse cx="520" cy="575" rx="12" ry="6" />
    <ellipse cx="535" cy="578" rx="8" ry="4" />
    <ellipse cx="780" cy="560" rx="10" ry="5" />
    <ellipse cx="160" cy="565" rx="9" ry="5" />
  </g>
  
  <!-- === WILDFLOWER ACCENTS === -->
  <g opacity="0.7">
    <!-- Cluster 1 -->
    <circle cx="180" cy="580" r="3" fill="#f7a8b8"/>
    <circle cx="195" cy="575" r="2.5" fill="#ffd700"/>
    <circle cx="210" cy="582" r="2" fill="#f7a8b8"/>
    <circle cx="188" cy="588" r="2" fill="#e8a0ff"/>
    <!-- Cluster 2 -->
    <circle cx="450" cy="590" r="3" fill="#ffd700"/>
    <circle cx="468" cy="585" r="2.5" fill="#f7a8b8"/>
    <circle cx="485" cy="592" r="2" fill="#ffd700"/>
    <circle cx="460" cy="596" r="2" fill="#a8d8ff"/>
    <!-- Cluster 3 -->
    <circle cx="750" cy="570" r="3" fill="#f7a8b8"/>
    <circle cx="768" cy="574" r="2.5" fill="#ffd700"/>
    <circle cx="740" cy="577" r="2" fill="#e8a0ff"/>
    <!-- Cluster 4 -->
    <circle cx="1020" cy="580" r="3" fill="#ffd700"/>
    <circle cx="1038" cy="573" r="2.5" fill="#f7a8b8"/>
    <circle cx="1010" cy="586" r="2" fill="#a8d8ff"/>
  </g>

  <!-- === SUN WITH CORONA AND RAYS === -->
  <g transform="translate(95 85)">
    <!-- Outer rays -->
    <g stroke="#fff8b0" stroke-width="2" opacity="0.3">
      <line x1="0" y1="-75" x2="0" y2="-95"/>
      <line x1="53" y1="-53" x2="67" y2="-67"/>
      <line x1="75" y1="0" x2="95" y2="0"/>
      <line x1="53" y1="53" x2="67" y2="67"/>
      <line x1="-53" y1="53" x2="-67" y2="67"/>
      <line x1="-75" y1="0" x2="-95" y2="0"/>
      <line x1="-53" y1="-53" x2="-67" y2="-67"/>
    </g>
    <circle cx="0" cy="0" r="70" fill="url(#sunCorona)"/>
    <circle cx="0" cy="0" r="48" fill="url(#sunGlow)" stroke="#f5e0a0" stroke-width="2"/>
    <text class="sun-label" x="0" y="-6" text-anchor="middle">Thin</text>
    <text class="sun-label" x="0" y="10" text-anchor="middle">orchestration</text>
  </g>

  <!-- === CLOUD 1 === -->
  <g transform="translate(300 140)">
    <rect x="-100" y="-40" rx="30" ry="30" width="200" height="80" fill="url(#cloudFill)" stroke="#90caf9" stroke-width="2"/>
    <text class="cloud-text" x="0" y="-6" text-anchor="middle">Pipeline over flags</text>
    <text class="cloud-text" x="0" y="14" text-anchor="middle">Ordered steps array</text>
  </g>

  <!-- === CLOUD 2 === -->
  <g transform="translate(600 115)">
    <rect x="-120" y="-38" rx="28" ry="28" width="240" height="76" fill="url(#cloudFill)" stroke="#90caf9" stroke-width="2"/>
    <text class="cloud-text" x="0" y="-6" text-anchor="middle">Each step: (ctx) ⇒</text>
    <text class="cloud-text" x="0" y="14" text-anchor="middle">{ ok, value } | { err, reason }</text>
  </g>

  <!-- === CLOUD 3 === -->
  <g transform="translate(940 160)">
    <rect x="-130" y="-40" rx="30" ry="30" width="260" height="80" fill="url(#cloudFill)" stroke="#90caf9" stroke-width="2"/>
    <text class="cloud-text" x="0" y="-6" text-anchor="middle">Config builds steps[]</text>
    <text class="cloud-text" x="0" y="14" text-anchor="middle">Only enabled filters pushed</text>
  </g>

  <!-- === BIRDS (distant silhouettes) === -->
  <g fill="none" stroke="#2d5545" stroke-width="1.5" stroke-linecap="round" opacity="0.4">
    <path d="M 420 200 Q 425 195 430 200 Q 435 195 440 200"/>
    <path d="M 455 190 Q 460 185 465 190 Q 470 185 475 190"/>
    <path d="M 490 205 Q 494 201 498 205 Q 502 201 506 205"/>
  </g>

  <!-- === PIPELINE STEPS === -->
  <g class="steps">
    <g transform="translate(140 520)">
      <rect x="-65" y="-30" rx="14" ry="14" width="130" height="60" fill="url(#stepBox)" stroke="url(#stepStroke)" stroke-width="2" filter="url(#cardShadow)"/>
      <text class="label" x="0" y="0" text-anchor="middle">configure()</text>
      <text class="hint" x="0" y="18" text-anchor="middle">options → flags</text>
    </g>
    <g transform="translate(340 520)">
      <rect x="-70" y="-30" rx="14" ry="14" width="140" height="60" fill="url(#stepBox)" stroke="url(#stepStroke)" stroke-width="2" filter="url(#cardShadow)"/>
      <text class="label" x="0" y="0" text-anchor="middle">buildSteps()</text>
      <text class="hint" x="0" y="18" text-anchor="middle">push enabled steps</text>
    </g>
    <g transform="translate(540 520)">
      <rect x="-65" y="-30" rx="14" ry="14" width="130" height="60" fill="url(#stepBox)" stroke="url(#stepStroke)" stroke-width="2" filter="url(#cardShadow)"/>
      <text class="label" x="0" y="0" text-anchor="middle">runPipeline()</text>
      <text class="hint" x="0" y="18" text-anchor="middle">ordered execution</text>
    </g>
    <g transform="translate(740 520)">
      <rect x="-60" y="-30" rx="14" ry="14" width="120" height="60" fill="url(#stepBox)" stroke="url(#stepStroke)" stroke-width="2" filter="url(#cardShadow)"/>
      <text class="label" x="0" y="0" text-anchor="middle">observe()</text>
      <text class="hint" x="0" y="18" text-anchor="middle">logger + metrics</text>
    </g>
    <g transform="translate(940 520)">
      <rect x="-60" y="-30" rx="14" ry="14" width="120" height="60" fill="url(#stepBox)" stroke="url(#stepStroke)" stroke-width="2" filter="url(#cardShadow)"/>
      <text class="label" x="0" y="0" text-anchor="middle">commit()</text>
      <text class="hint" x="0" y="18" text-anchor="middle">write + finalize</text>
    </g>
  </g>

  <!-- === CONNECTOR ARROWS === -->
  <g stroke="#5cf5ab" stroke-width="3" fill="none" marker-end="url(#arrow)">
    <line x1="205" y1="520" x2="260" y2="520"/>
    <line x1="410" y1="520" x2="465" y2="520"/>
    <line x1="605" y1="520" x2="670" y2="520"/>
    <line x1="800" y1="520" x2="870" y2="520"/>
  </g>

  <!-- === GROUND LABELS === -->
  <text class="ground-label" x="140" y="660" text-anchor="middle">flags → steps list</text>
  <text class="ground-label" x="540" y="660" text-anchor="middle">runPipeline(steps, ctx, deps)</text>
  <text class="ground-label" x="940" y="660" text-anchor="middle">observer + metrics</text>
</svg>
