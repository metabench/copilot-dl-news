# Plan – jsgui3 Stack Regression Sweep

## Objective
Run a broad UI test+check baseline pre-update, then re-run post-update and fix regressions (focus: jsgui3-client + SSR UI servers + Puppeteer E2E stability).

## Done When
- [ ] Baseline test suite is repeatable (no known flakes).
- [ ] Baseline evidence (commands + pass summaries) is captured in `WORKING_NOTES.md`.
- [ ] SSR check artifacts are generated (HTML/JSON outputs) for manual diffs.
- [ ] Clear GO/NO-GO gate for npm upgrade is recorded in `SESSION_SUMMARY.md`.
- [ ] Follow-ups (optional suites, hygiene, tool updates) are recorded in `FOLLOW_UPS.md`.

## Change Set (initial sketch)
- Tests: stabilize Puppeteer E2Es so the baseline is trustworthy.
	- `tests/ui/e2e/url-filter-toggle.puppeteer.e2e.test.js`
	- (earlier in the session) `tests/ui/e2e/art-playground-resize.puppeteer.e2e.test.js`
- Evidence artifacts (generated by checks): `*.check.html`, `*.check.json`.
- Documentation: this session folder.

## Risks & Mitigations
- **Puppeteer flakiness**: hydrate timing and hard-coded ports.
	- Mitigation: use dynamic ports, `waitUntil: "load"`, and explicit readiness waits.
- **Long-running servers hanging CI**:
	- Mitigation: use `--check` servers and dedicated check scripts only.
- **Parallel check runs are easy to interrupt and can look like failures**:
	- Mitigation: run SSR check scripts sequentially for baseline evidence.

## Tests / Validation
- SSR checks (produce artifacts in repo root unless noted):
	- `npm run diagram:check` → `diagram-atlas.check.html`
	- `npm run ui:decision-tree:check` → `decision-tree-viewer.check.html`
	- `node src/ui/server/checks/dataExplorer.check.js` → `data-explorer.*.check.html`
	- `node src/ui/server/checks/dataExplorerUrlFilters.check.js` → `data-explorer.urls.*.check.html` + `data-explorer.urls.filters.check.json`
	- `node src/ui/server/checks/facts.check.js` → `facts.check.html`
	- `node src/ui/server/checks/homeDashboard.check.js` → `tmp/home.html`

- Jest suites:
	- `npm run test:by-path tests/server/diagram-atlas.e2e.test.js tests/ui/server/decisionTreeViewer.connection.e2e.test.js`
	- `npm run test:by-path tests/ui/e2e/art-playground.puppeteer.e2e.test.js tests/ui/e2e/art-playground-resize.puppeteer.e2e.test.js tests/ui/e2e/url-filter-toggle.puppeteer.e2e.test.js tests/ui/e2e/wysiwyg-demo.puppeteer.e2e.test.js`
	- `npm run test:by-path tests/ui/server/dataExplorerServer.test.js tests/ui/server/dataExplorerServer.production.test.js`
