# Working Notes – UI bugs identification and plan

- 2025-12-11 — Found dynamic tree switching bug in DecisionTree viewer: `DecisionTreeViewerControl.displayTree` builds a new `DecisionTreeControl` then injects `all_html_render()` into `canvasEl.innerHTML`, so the control instance is not bound to the DOM. Result: tree list selection produces static markup with dead event handlers and no SVG connection rendering; previous `DecisionTreeControl` (with ResizeObserver/ConnectionRenderer) may leak. Fix plan: clear canvas children and mount the new control via jsgui3 (`canvas.clear()`/`remove_all()` then `canvas.add(newControl)`), then `activate` the new control and rewire events instead of using `innerHTML`.
- 2025-12-11 — Found tree setter no-op bug: `DecisionTreeControl.set tree()` resets internal maps/selection but does not re-compose or redraw, leaving the existing DOM unchanged when swapping the tree on an existing control. Any code that sets `tree` expects rerender but gets stale UI. Fix plan: implement a re-render path in setter (dispose old renderer, clear children, rebuild levels/connectors via `compose()`, then `activate()`/`_initConnections()`).
- 2025-12-11 — Implemented fixes: `displayTree` now disposes prior control, clears canvas, adds new control, and relies on jsgui3 lifecycle (with explicit activate as safeguard). Tree setter now tears down observers/renderers, clears children, updates `data-tree-id`, recomposes, and reactivates when already active. Added text fixture in `decisionTreeViewer.check.js` to assert the setter renders a new tree (checks `data-tree-id="alt-tree"`). Check script passes post-fix.
- 2025-12-11 — Added multi-tree render fixture in `decisionTreeViewer.check.js` to ensure tree list renders multiple items and both names appear. Added npm script `ui:decision-tree:check` for CI-friendly execution. Check now reports 53/53 passing.
