<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 800">
  <defs>
    <!-- Background gradient -->
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0a0a0f"/>
      <stop offset="100%" style="stop-color:#1a1a2e"/>
    </linearGradient>
    
    <!-- Error/Trigger gradient -->
    <linearGradient id="errorGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b2020"/>
      <stop offset="100%" style="stop-color:#5a1515"/>
    </linearGradient>
    
    <!-- Service gradient -->
    <linearGradient id="serviceGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3a4a6a"/>
      <stop offset="100%" style="stop-color:#2a3a5a"/>
    </linearGradient>
    
    <!-- Diagnosis gradient -->
    <linearGradient id="diagGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b6914"/>
      <stop offset="100%" style="stop-color:#5a4510"/>
    </linearGradient>
    
    <!-- Remediation gradient -->
    <linearGradient id="remGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2d6a4d"/>
      <stop offset="100%" style="stop-color:#1a4a35"/>
    </linearGradient>
    
    <!-- Report gradient -->
    <linearGradient id="reportGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4a4a7a"/>
      <stop offset="100%" style="stop-color:#3a3a6a"/>
    </linearGradient>
    
    <!-- Gold accent gradient -->
    <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#8b7320"/>
      <stop offset="50%" style="stop-color:#c9a227"/>
      <stop offset="100%" style="stop-color:#8b7320"/>
    </linearGradient>
    
    <!-- Glow filter -->
    <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <filter id="softGlow" x="-10%" y="-10%" width="120%" height="120%">
      <feGaussianBlur stdDeviation="1" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <!-- Arrow markers -->
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#c9a227"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#5cb85c"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#cc4444"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="100%" height="100%" fill="url(#bgGrad)"/>
  
  <!-- Corner accents -->
  <path d="M 20 8 L 20 20 L 8 20" stroke="#c9a227" stroke-width="2" fill="none"/>
  <path d="M 1380 8 L 1380 20 L 1392 20" stroke="#c9a227" stroke-width="2" fill="none"/>
  <path d="M 20 792 L 20 780 L 8 780" stroke="#c9a227" stroke-width="2" fill="none"/>
  <path d="M 1380 792 L 1380 780 L 1392 780" stroke="#c9a227" stroke-width="2" fill="none"/>
  
  <!-- Title -->
  <text x="700" y="40" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="22" font-weight="600" fill="#e8e8e8" letter-spacing="2" filter="url(#softGlow)">SELF-HEALING SERVICE WORKFLOW</text>
  <text x="700" y="62" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#888" letter-spacing="1">AUTOMATIC ERROR RECOVERY · DIAGNOSIS → REMEDIATION → REPORTING</text>
  
  <!-- Decorative line under title -->
  <line x1="400" y1="75" x2="1000" y2="75" stroke="url(#goldGrad)" stroke-width="1"/>
  
  <!-- TRIGGER -->
  <rect x="50" y="100" width="160" height="70" fill="url(#errorGrad)" stroke="#cc4444" stroke-width="2" rx="5" filter="url(#softGlow)"/>
  <text x="130" y="130" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" fill="#e8e8e8">Crawler Error</text>
  <text x="130" y="150" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#ff9999">Timeout, 429, 403, etc.</text>
  
  <!-- Arrow to Service -->
  <path d="M 210 135 L 270 135" stroke="#c9a227" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- SELF HEALING SERVICE -->
  <rect x="270" y="90" width="200" height="90" fill="url(#serviceGrad)" stroke="#c9a227" stroke-width="2" rx="5" filter="url(#softGlow)"/>
  <text x="370" y="120" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" fill="#e8e8e8">SelfHealingService</text>
  <text x="370" y="140" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#aaa">Main orchestration</text>
  <text x="370" y="160" text-anchor="middle" font-family="Segoe UI Mono, monospace" font-size="8" fill="#888">src/core/crawler/healing/</text>
  
  <!-- Arrow to Diagnosis -->
  <path d="M 470 135 L 530 135" stroke="#c9a227" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- PHASE 1: DIAGNOSIS -->
  <rect x="530" y="90" width="340" height="300" fill="rgba(139,105,20,0.15)" stroke="#c9a227" stroke-width="2" rx="8"/>
  <text x="700" y="115" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" fill="#c9a227" letter-spacing="1">PHASE 1: DIAGNOSIS</text>
  <text x="700" y="132" text-anchor="middle" font-family="Segoe UI Mono, monospace" font-size="9" fill="#888">DiagnosticEngine.js</text>
  
  <!-- Failure Types -->
  <text x="550" y="160" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" fill="#c9a227">Failure Types:</text>
  
  <rect x="550" y="170" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="620" y="192" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">RATE_LIMITED</text>
  
  <rect x="710" y="170" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="780" y="192" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">BLOCKED</text>
  
  <rect x="550" y="215" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="620" y="237" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">TIMEOUT</text>
  
  <rect x="710" y="215" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="780" y="237" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">PROXY_FAILURE</text>
  
  <rect x="550" y="260" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="620" y="282" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">NETWORK_ERROR</text>
  
  <rect x="710" y="260" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="780" y="282" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">CONTENT_MISMATCH</text>
  
  <rect x="550" y="305" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="620" y="327" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">CAPTCHA</text>
  
  <rect x="710" y="305" width="140" height="35" fill="rgba(139,105,20,0.3)" stroke="rgba(201,162,39,0.5)" stroke-width="1" rx="3"/>
  <text x="780" y="327" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">UNKNOWN</text>
  
  <!-- Diagnostic output -->
  <rect x="550" y="350" width="300" height="30" fill="rgba(201,162,39,0.25)" stroke="#c9a227" stroke-width="1" rx="3"/>
  <text x="700" y="370" text-anchor="middle" font-family="Segoe UI Mono, monospace" font-size="9" fill="#c9a227">{ failureType, severity, context }</text>
  
  <!-- Arrow to Remediation -->
  <path d="M 870 240 L 920 240" stroke="#5cb85c" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
  
  <!-- PHASE 2: REMEDIATION -->
  <rect x="920" y="90" width="420" height="300" fill="rgba(45,106,77,0.15)" stroke="#5cb85c" stroke-width="2" rx="8"/>
  <text x="1130" y="115" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" fill="#5cb85c" letter-spacing="1">PHASE 2: REMEDIATION</text>
  <text x="1130" y="132" text-anchor="middle" font-family="Segoe UI Mono, monospace" font-size="9" fill="#888">RemediationStrategies.js</text>
  
  <!-- Strategies -->
  <text x="940" y="160" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" fill="#5cb85c">Remediation Strategies:</text>
  
  <rect x="940" y="170" width="180" height="45" fill="rgba(92,184,92,0.15)" stroke="rgba(92,184,92,0.5)" stroke-width="1" rx="3"/>
  <text x="1030" y="190" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">Rate Limit Backoff</text>
  <text x="1030" y="205" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Exponential delay</text>
  
  <rect x="1140" y="170" width="180" height="45" fill="rgba(92,184,92,0.15)" stroke="rgba(92,184,92,0.5)" stroke-width="1" rx="3"/>
  <text x="1230" y="190" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">Proxy Rotation</text>
  <text x="1230" y="205" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Switch to fresh proxy</text>
  
  <rect x="940" y="225" width="180" height="45" fill="rgba(92,184,92,0.15)" stroke="rgba(92,184,92,0.5)" stroke-width="1" rx="3"/>
  <text x="1030" y="245" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">Puppeteer Fallback</text>
  <text x="1030" y="260" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Switch to headless browser</text>
  
  <rect x="1140" y="225" width="180" height="45" fill="rgba(92,184,92,0.15)" stroke="rgba(92,184,92,0.5)" stroke-width="1" rx="3"/>
  <text x="1230" y="245" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">Domain Cooldown</text>
  <text x="1230" y="260" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Pause domain requests</text>
  
  <rect x="940" y="280" width="180" height="45" fill="rgba(92,184,92,0.15)" stroke="rgba(92,184,92,0.5)" stroke-width="1" rx="3"/>
  <text x="1030" y="300" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">Header Adjustment</text>
  <text x="1030" y="315" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Modify request headers</text>
  
  <rect x="1140" y="280" width="180" height="45" fill="rgba(92,184,92,0.15)" stroke="rgba(92,184,92,0.5)" stroke-width="1" rx="3"/>
  <text x="1230" y="300" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">Skip &amp; Log</text>
  <text x="1230" y="315" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Unrecoverable → skip</text>
  
  <!-- Remediation output -->
  <rect x="940" y="340" width="380" height="40" fill="rgba(92,184,92,0.25)" stroke="#5cb85c" stroke-width="1" rx="3"/>
  <text x="1130" y="358" text-anchor="middle" font-family="Segoe UI Mono, monospace" font-size="9" fill="#5cb85c">{ retry, delayMs, strategy, context }</text>
  <text x="1130" y="373" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Returns whether to retry and how</text>
  
  <!-- PHASE 3: REPORTING -->
  <rect x="50" y="450" width="440" height="150" fill="rgba(74,74,122,0.15)" stroke="#8888cc" stroke-width="2" rx="8"/>
  <text x="270" y="475" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" fill="#8888cc" letter-spacing="1">PHASE 3: REPORTING</text>
  <text x="270" y="492" text-anchor="middle" font-family="Segoe UI Mono, monospace" font-size="9" fill="#888">HealingReport.js</text>
  
  <rect x="70" y="510" width="180" height="35" fill="rgba(136,136,204,0.15)" stroke="rgba(136,136,204,0.5)" stroke-width="1" rx="3"/>
  <text x="160" y="532" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">Log healing attempt</text>
  
  <rect x="270" y="510" width="200" height="35" fill="rgba(136,136,204,0.15)" stroke="rgba(136,136,204,0.5)" stroke-width="1" rx="3"/>
  <text x="370" y="532" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">Track failure patterns</text>
  
  <rect x="70" y="555" width="180" height="35" fill="rgba(136,136,204,0.15)" stroke="rgba(136,136,204,0.5)" stroke-width="1" rx="3"/>
  <text x="160" y="577" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">Update domain health</text>
  
  <rect x="270" y="555" width="200" height="35" fill="rgba(136,136,204,0.15)" stroke="rgba(136,136,204,0.5)" stroke-width="1" rx="3"/>
  <text x="370" y="577" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#e8e8e8">Emit events for telemetry</text>
  
  <!-- Arrow from remediation to reporting -->
  <path d="M 1130 390 L 1130 420 L 270 420 L 270 450" stroke="#c9a227" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- EXTERNAL SERVICES -->
  <rect x="530" y="450" width="340" height="150" fill="rgba(136,68,136,0.15)" stroke="#aa66aa" stroke-width="2" rx="8"/>
  <text x="700" y="475" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" fill="#aa66aa" letter-spacing="1">EXTERNAL SERVICES</text>
  
  <rect x="550" y="500" width="140" height="40" fill="rgba(170,102,170,0.2)" stroke="rgba(170,102,170,0.5)" stroke-width="1" rx="3"/>
  <text x="620" y="518" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">ProxyManager</text>
  <text x="620" y="532" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Proxy pool rotation</text>
  
  <rect x="710" y="500" width="140" height="40" fill="rgba(170,102,170,0.2)" stroke="rgba(170,102,170,0.5)" stroke-width="1" rx="3"/>
  <text x="780" y="518" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">RateLimitTracker</text>
  <text x="780" y="532" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Per-domain limits</text>
  
  <rect x="550" y="550" width="140" height="40" fill="rgba(170,102,170,0.2)" stroke="rgba(170,102,170,0.5)" stroke-width="1" rx="3"/>
  <text x="620" y="568" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">PuppeteerDomainMgr</text>
  <text x="620" y="582" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Headless browser pool</text>
  
  <rect x="710" y="550" width="140" height="40" fill="rgba(170,102,170,0.2)" stroke="rgba(170,102,170,0.5)" stroke-width="1" rx="3"/>
  <text x="780" y="568" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="500" fill="#e8e8e8">DomainHealthTracker</text>
  <text x="780" y="582" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">Domain status</text>
  
  <!-- OUTCOME -->
  <rect x="920" y="450" width="420" height="150" fill="rgba(26,26,46,0.8)" stroke="rgba(201,162,39,0.5)" stroke-width="2" rx="8"/>
  <text x="1130" y="475" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" fill="#c9a227" letter-spacing="1">OUTCOME</text>
  
  <!-- Outcome Decision -->
  <polygon points="1040,520 1090,490 1140,520 1090,550" fill="#1a1a2e" stroke="#c9a227" stroke-width="2"/>
  <text x="1090" y="525" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" fill="#c9a227">Retry?</text>
  
  <!-- Yes path -->
  <path d="M 1140 520 L 1200 520" stroke="#5cb85c" stroke-width="2" fill="none"/>
  <text x="1165" y="512" font-family="Segoe UI, sans-serif" font-size="9" fill="#5cb85c">Yes</text>
  <rect x="1200" y="495" width="120" height="50" fill="rgba(92,184,92,0.2)" stroke="#5cb85c" stroke-width="2" rx="5" filter="url(#softGlow)"/>
  <text x="1260" y="518" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" font-weight="600" fill="#5cb85c">Retry Request</text>
  <text x="1260" y="535" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#888">After delayMs</text>
  
  <!-- No path -->
  <path d="M 1090 550 L 1090 575" stroke="#cc4444" stroke-width="2" fill="none"/>
  <text x="1100" y="565" font-family="Segoe UI, sans-serif" font-size="9" fill="#cc4444">No</text>
  <rect x="1020" y="575" width="140" height="35" fill="rgba(204,68,68,0.2)" stroke="#cc4444" stroke-width="2" rx="5"/>
  <text x="1090" y="598" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" font-weight="600" fill="#cc4444">Skip / Abort</text>
  
  <!-- Module Legend -->
  <rect x="50" y="640" width="1290" height="100" fill="rgba(26,26,46,0.8)" stroke="rgba(201,162,39,0.3)" stroke-width="1" rx="5"/>
  <text x="700" y="665" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" font-weight="600" fill="#c9a227" letter-spacing="1">KEY MODULE PATHS</text>
  
  <line x1="100" y1="675" x2="1300" y2="675" stroke="rgba(201,162,39,0.2)" stroke-width="1"/>
  
  <text x="100" y="695" font-family="Segoe UI Mono, monospace" font-size="9" fill="#aaa">Healing:  src/core/crawler/healing/ (SelfHealingService.js, DiagnosticEngine.js, RemediationStrategies.js, HealingReport.js)</text>
  <text x="100" y="715" font-family="Segoe UI Mono, monospace" font-size="9" fill="#aa66aa">Services: ProxyManager, RateLimitTracker, PuppeteerDomainManager, DomainHealthTracker</text>
  <text x="100" y="735" font-family="Segoe UI Mono, monospace" font-size="9" fill="#888">Events:   healing:attempt, healing:success, healing:failure, healing:skip</text>
</svg>