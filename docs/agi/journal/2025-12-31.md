# 2025-12-31 — Place + Topic Hub Guessing Matrices

## Known facts
- Place Hub Guessing matrix already supports `matrixMode` (`auto|table|virtual`) and uses `VirtualMatrixControl` for large grids.
- Place Hub Guessing filters exist for kind/pageKind/placeQ/hostQ/limits, but `state` is not exposed even though links already propagate it.
- Topic hub prediction + validation infrastructure exists (`TopicHubGapAnalyzer`, orchestrator persistence via `insertTopicHub`/`getTopicHub`).

## Ranked options
| Option | Impact | Effort | Risk | Domains |
| --- | --- | --- | --- | --- |
| A) Place matrix quick wins (state filter, persist flip) | High | S–M | Low | UI |
| B) Topic Hub Guessing matrix (topic × host) | High | M | Medium | UI + Data |
| C) Unified Hub Guessing Explorer (tabs) | Very high | L | Medium–High | UI + Data |

## Next experiments
1) Confirm the DB-side status model for PlaceHubGuessing’s `mapping.status` / `verified_at` so TopicHubGuessing can reuse the same semantics.
2) Decide Topic matrix “best URL per cell” rule (single winner vs list in drilldown).
3) Start with SSR-only matrix + a minimal check before adding extra UX.

---

# 2025-12-31 — Decision Review UI (Pause-on-decision crawl)

## Known facts
- There is already a task-events-backed Crawl Observer UI: `src/ui/server/crawlObserver/server.js` (port 3007).
- There is already a Decision Tree Viewer UI: `src/ui/server/decisionTreeViewer/server.js` (port 3030) with an isomorphic `DecisionTree` model and loader from config and `DecisionConfigSet`.
- There is a decision tree execution engine with an audit trail at `src/analysis/decisionTreeEngine.js` (not confirmed in production path).

## Ranked options
| Option | Impact | Effort | Risk | Domains |
| --- | --- | --- | --- | --- |
| A) Extend Crawl Observer for “Decision Review” (list + detail + pause/continue) | Very high | M | Medium | UI + Data + Ops |
| B) New Unified App sub-app (Decision stream + embedded tree viewer) | Very high | L | Medium–High | UI + Data + Ops |
| C) Data Explorer explainability-on-demand (URL → facts → classification path) | High | S–M | Low–Medium | UI + Data |

## Next experiments
1) Identify 1–2 real crawler decision points to instrument first (MVP) and what “premises” means there.
2) Choose the control-plane mechanism for pausing (DB table vs in-process channel).
3) Define a minimal `task_events.payload_json` schema for a `decision` event that can grow without breaking consumers.

---

# 2025-12-31 — Unified App: Crawl Observer single-service

## Known facts
- Unified App already mounts multiple dashboards as routers inside one Express process (`mountDashboardModules()` in `src/ui/server/unifiedApp/server.js`).
- Unified App UX embeds most tools via iframes to mounted paths (`src/ui/server/unifiedApp/subApps/registry.js`).
- Crawl Observer should be reachable through the unified server/port (no extra listener), but the registry currently shows a placeholder that references a separate port.

## Ranked options
| Option | Impact | Effort | Risk | Domains |
| --- | --- | --- | --- | --- |
| A) In-process mount under `/crawl-observer` + iframe embed | High | S | Medium | UI + Ops |
| B) Reverse-proxy to legacy Crawl Observer server (temporary) | Medium | S | Low–Medium | Ops |
| C) Native Unified App integration (no iframe; shared shell state) | Very high | L | Medium–High | UI |

## Key risks / unknowns
- Crawl Observer internal links may be absolute (`/task/...`) and will break when mounted under `/crawl-observer` unless it supports a base path.
- DB access wiring: Unified App uses `openNewsDb` and passes handles down; Crawl Observer should accept the unified DB handle to avoid opening a second one.

## Next experiments
1) Verify Crawl Observer can run mounted under a base path without broken links (quick manual test).
2) Add a focused Jest assertion in `tests/ui/unifiedApp.registry.test.js` for the Crawl Observer iframe src.
3) If basePath is required, standardize a `basePath` option pattern across SSR controls for mounted apps.

