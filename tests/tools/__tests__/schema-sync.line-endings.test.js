'use strict';

const { contentHash } = require('../../../tools/schema-sync');

describe('schema-sync contentHash', () => {
  test('treats CRLF and LF as equivalent', () => {
    const lf = "line1\nline2\n";
    const crlf = "line1\r\nline2\r\n";

    expect(contentHash(lf)).toBe(contentHash(crlf));
  });

  test('ignores Generated at timestamp line', () => {
    const a = [
      '/**',
      ' * AUTO-GENERATED by tools/schema-sync.js',
      ' * Generated at 2025-12-30T00:00:00.000Z',
      ' */',
      'const X = 1;',
      ''
    ].join('\n');

    const b = [
      '/**',
      ' * AUTO-GENERATED by tools/schema-sync.js',
      ' * Generated at 2025-12-30T11:11:11.111Z',
      ' */',
      'const X = 1;',
      ''
    ].join('\n');

    expect(contentHash(a)).toBe(contentHash(b));
  });
});
